# Product Requirements Document
## Mission Impossible Task Briefing System

**Version:** 1.1  
**Last Updated:** December 2025

---

## 1. Problem & Vision

**Problem:**
Users waste mental energy checking multiple platforms (Gmail, Slack, LinkedIn, Calendar, WhatsApp, Notion) throughout the day. Important tasks get buried in notification noise, leading to missed deadlines and constant context-switching overhead.

**Vision:**
A Raspberry Pi‚Äìpowered desktop device that prints daily tasks as Mission-Impossible‚Äìstyle briefings. Tasks are generated by an LLM (local or remote) from monitored digital channels and delivered through a thermal receipt printer for a fun, tactile productivity experience that creates immediate awareness and accountability.

**Core Principle:**
"The user should never have to check anything. The AI checks everything and delivers only what matters."

---

## 2. User Experience

### 2.1 Primary Interaction Flow
1. Something happens (email arrives, Slack message, calendar event, etc.)
2. AI analyzes and determines if it's actionable
3. If actionable, receipt prints immediately with task details
4. User picks up receipt, reads task, takes action
5. User marks complete via Telegram/web interface
6. System tracks completion

### 2.2 Key User Needs
- **Zero manual checking** of any digital platform
- **Zero missed tasks** regardless of source
- **Immediate awareness** of urgent items
- **Physical accountability** through printed receipts
- **No artificial limits** on number of tasks per day
- **Simple completion tracking** without opening apps

---

## 3. Core Requirements

### 3.1 Channel Monitoring
**Must Support (Phase 1):**
- Gmail (primary focus for initial implementation)

**Future Phases:**
- Slack (all workspaces, channels, DMs)
- Google Calendar
- LinkedIn (messages, job posts)
- Notion
- WhatsApp
- Call logs (via Home Assistant integration)
- Personal todo apps

**Monitoring Behavior:**
- Continuous operation (24/7)
- Real-time where possible (webhooks), polling otherwise (5-15 min intervals)
- Graceful error handling and retry logic
- Configurable per-channel enable/disable

### 3.2 Task Extraction & Classification

**AI Must Determine:**
- Is this actionable? (Yes/No)
- If yes: What's the clear action required?
- Who's involved?
- What's the deadline (explicit or implied)?
- How urgent is this?

**Urgency Levels:**

| Level | Criteria | Symbol |
|-------|----------|--------|
| **CRITICAL** | Needs action within 2 hours, high-stakes impact | üî•üî• |
| **HIGH** | Needs action today/tomorrow | ‚ö†Ô∏è |
| **MEDIUM** | Needs action within 3-7 days | ‚≠ê |
| **LOW** | Trackable, no urgent deadline | üìã |
| **INFO** | No action required, reference only | ‚ÑπÔ∏è |

### 3.3 Thermal Printer Output

**Hardware:**
- 58mm thermal receipt printer
- Connected to Raspberry Pi (USB/Serial)
- Supports ESC/POS commands

**Print Format (Mission Impossible Style):**
```
========================================
    MISSION BRIEFING - [URGENCY LEVEL]
========================================

AGENT: [User Name]
MISSION: [One-line actionable description]

SOURCE: [Platform + sender/context]
TIME RECEIVED: [When detected]
DEADLINE: [Date/time or "ASAP"]

INTELLIGENCE REPORT:
[2-3 sentences of context]
[Key people involved]

YOUR MISSION, SHOULD YOU CHOOSE TO
ACCEPT IT:
[Specific action required]

‚ö†Ô∏è  THIS MESSAGE WILL SELF-DESTRUCT
    IN [TIME UNTIL DEADLINE]

========================================
MISSION ID: [Unique identifier]
========================================
```

**Print Behavior:**
- Immediate print upon task creation (no batching unless configured)
- No daily limit on number of prints
- Optional quiet hours (e.g., no printing 11pm-7am)
- Auto-cut between receipts (if printer supports)

**Format Requirements:**
- 32-42 characters per line (58mm width)
- Bold headers for urgency
- Clear visual hierarchy
- Box drawing characters for separation
- Scannable at a glance

### 3.4 Task Management

**Task States:**
- NEW ‚Üí IN_PROGRESS ‚Üí COMPLETED
- NEW ‚Üí CANCELLED
- NEW ‚Üí BLOCKED ‚Üí IN_PROGRESS ‚Üí COMPLETED

**User Operations:**
- Mark complete
- Snooze/defer
- Add notes
- Cancel/dismiss

**System Operations:**
- Auto-escalate if deadline approaching
- Re-print CRITICAL tasks if not completed by deadline
- Track completion metrics

### 3.5 Control Interfaces

**Google Tasks Integration (Primary):**
- Auto-create tasks in Google Tasks for each mission briefing
- Task title matches mission title from AI analysis  
- Task notes contain full mission briefing details
- Due dates set based on AI-detected deadlines
- User completes tasks in Google Tasks app (mobile/web)
- System syncs completion status back to local database
- Leverages existing Google ecosystem integration

**SSH Command Interface:**
- Direct Pi access for system management
- Mission status queries and manual overrides
- System diagnostics and configuration

**Daily Mission Briefings:**
- Morning intelligence report at 8am
- Evening mission debrief at 6pm
- Prints overview of day's missions

---

## 4. Technical Constraints

### 4.1 Hardware
- **Raspberry Pi Zero 2W** (optimal for API-based approach at $15)
- Reliable power supply (5V/2.5A recommended)
- Network connectivity (WiFi built-in)
- 58mm thermal printer with ESC/POS support (USB connection)
- SSH connectivity for remote management

**Optional Enhancements:**
- Whisplay HAT for Pi Zero 2W (adds 1.69" display, speaker, dual microphones)
- Voice interface capabilities for hands-free mission updates

### 4.2 Software Stack
**Confirmed Working Components:**
- **Python FastAPI** - Main application framework
- **Google Gemini 2.5 Flash Lite API** - AI task extraction and analysis
- **SQLite database** - Mission storage and tracking
- **ESC/POS printer library** - Thermal receipt printing
- **Google Tasks API** - Mission control and completion tracking
- **APScheduler** - Background email monitoring
- **Python-dotenv** - Secure credential management

**Confirmed Integration Points:**
- **Gmail API** - Email monitoring and content extraction ‚úÖ WORKING
- **Google Gemini API** - AI task analysis ‚úÖ WORKING  
- **Google Tasks API** - Mission management ‚úÖ WORKING

**Future Integration Points:**
- Slack API (team messaging)
- Google Calendar API (meeting/event tasks)
- WhatsApp Business API (customer communications)
- Home Assistant API (call log monitoring and IoT device integration)

### 4.3 Non-Functional Requirements
- **Reliability:** 99.5%+ uptime
- **Latency:** Tasks print within 30 seconds of detection
- **Accuracy:** <10% false positive rate
- **Recovery:** Auto-resume after failures
- **Security:** Secure credential storage, encrypted communications

---

## 5. Key Design Decisions

### 5.1 Why Physical Printing?
- Cannot be ignored like digital notifications
- Creates tangible accountability
- No screen time required
- Works even when devices are off/away
- Satisfying physical interaction

### 5.2 No Print Limits
- User explicitly wants unlimited daily tasks
- Busier days naturally generate more prints
- No artificial batching that could delay urgent items
- System handles volume, doesn't restrict it

### 5.3 Immediate vs. Batched Printing
- Default: Immediate print for each task
- Optional: Batch mode for non-critical (e.g., every 30 min)
- CRITICAL always prints immediately
- User configurable per preference

### 5.4 Classification Philosophy
- Err on side of over-notifying early, then learn
- User feedback improves accuracy over time
- Better to print and cancel than to miss something important
- Urgency classification is subjective and user-specific

### 5.5 Home Assistant Integration for Call Monitoring
**Decision:** Use Home Assistant to monitor call logs and trigger tasks based on call patterns.

**Rationale:**
- Home Assistant provides unified IoT platform for call log monitoring
- Can integrate with various phone systems (Android, VoIP, landline)
- Enables automation based on call patterns (missed calls, frequent callers)
- Provides webhook/API endpoints for real-time call notifications
- Allows future expansion to other IoT devices (door sensors, motion detectors)

**Implementation Approach:**
- Install Home Assistant on same Raspberry Pi or dedicated device
- Configure phone integration (Android companion app or VoIP integration)
- Set up automation rules to POST call events to pi2printer API
- Use AI to analyze call patterns and generate follow-up tasks
- Examples: "Call back John - missed call 3x today (HIGH priority)"

**Installation Notes:**
- For Pi Zero 2W: Consider Python venv over Docker for better performance
- Docker adds ~50-100MB overhead on 512MB device
- Python venv provides better resource utilization for constrained hardware

---

## 6. Success Criteria

**Must Achieve:**
1. Zero manually checked platforms (user never opens Gmail/Slack to "check")
2. Zero missed important tasks (as reported by user)
3. >90% task completion rate for CRITICAL items
4. <1 hour response time for CRITICAL tasks

**Should Achieve:**
1. <10% false positive rate (printed items that weren't really tasks)
2. >95% system uptime
3. User reports reduced stress/mental load
4. All prints occur within 30 seconds of detection

**Nice to Have:**
1. Predictive task creation based on patterns
2. Integration with 10+ different platforms
3. Multi-user household support
4. Voice interface

---

## 7. Out of Scope (For Now)

- Automatic task execution (AI taking actions on user's behalf)
- Payment processing or financial transactions
- Complex project management features (dependencies, Gantt charts)
- Mobile app (Telegram bot is sufficient initially)
- Task delegation to others
- Integration with physical IoT devices beyond printer

---

## 8. Open Questions for Implementation

These are intentionally left open for implementer creativity:

1. **Architecture:** n8n vs. custom Python vs. hybrid approach?
2. **LLM:** Cloud API vs. local model? Which specific model?
   **Decision Made:** Cloud API (Google Gemini) for Phase 1
   - Local LLM on Pi 2W would be too slow (10+ minutes per analysis)
   - API costs are reasonable for expected usage (~$5-30/month)
   - Can migrate to local model later if usage grows significantly
   - Best models for Pi would be <3B parameters (Gemma3:1B, TinyLlama)
3. **Database:** PostgreSQL vs. SQLite vs. other?
4. **Task deduplication:** How to handle same task from multiple sources?
5. **Learning mechanism:** How does system improve classification over time?
6. **Backup notification:** What if printer fails? Telegram fallback?
7. **Print queue:** How to handle print failures gracefully?
8. **Configuration UI:** Web dashboard vs. config files vs. chat commands?
9. **Analytics:** What metrics to track and how to present them?
10. **Multi-device:** Could there be multiple printers in different rooms?
11. **Home Assistant Integration:** How to monitor call logs and trigger tasks based on call patterns/missed calls?

---

## 9. Sample Data Flows

### Email to Printed Task
```
Gmail ‚Üí Webhook/Poll ‚Üí AI Analyzer ‚Üí Task Created ‚Üí Printer Service ‚Üí Physical Receipt
```

### Slack Mention to Task
```
Slack ‚Üí Webhook ‚Üí AI Analyzer ‚Üí Urgency: CRITICAL ‚Üí Immediate Print ‚Üí User Notified
```

### Task Completion
```
User ‚Üí Telegram Bot ‚Üí "Done TASK-001" ‚Üí Database Update ‚Üí Confirmation Message
```

### Daily Summary
```
Scheduled Trigger ‚Üí Query All Today's Tasks ‚Üí AI Summarizer ‚Üí Formatted Print ‚Üí User Receives Overview
```

---

## 10. Configuration Examples

Users should be able to configure:

**Channel Settings:**
- Which sources to monitor
- Polling frequency per source
- VIP senders (always create task)
- Keyword filters (always/never triggers)

**Urgency Thresholds:**
- Custom criteria for each level
- Auto-escalation rules
- Specific sender/keyword urgency overrides

**Print Settings:**
- Quiet hours
- Batch vs. immediate mode
- Print format preferences (more/less detail)
- Daily summary timing

**Notification Settings:**
- Telegram backup for CRITICAL items
- Daily summary format
- Completion confirmations

---

## 11. Future Possibilities

**Potential Enhancements** (not required, just inspirational):
- Voice interface on Raspberry Pi
- QR codes on receipts linking to full context
- Color-coded paper rolls for different urgency levels
- Multi-user support (family/team)
- Smart time-blocking suggestions
- Integration with pomodoro technique
- Predictive task creation
- Auto-draft responses for common emails
- Context synthesis across multiple sources
- Mobile app for on-the-go task management

---

## Appendix: Prompt Template for Task Extraction

```
Analyze this content and extract actionable tasks:

SOURCE: {source_name}
FROM: {sender}
CONTENT: {content}
TIMESTAMP: {timestamp}

Determine:
1. Is there an actionable task? (yes/no)
2. If yes:
   - Task title (one clear sentence)
   - Urgency: CRITICAL/HIGH/MEDIUM/LOW/INFO
   - Deadline (if any)
   - People involved
   - Specific action required
   - Brief context (2-3 sentences)

Urgency criteria:
- CRITICAL: <2 hours, high-stakes
- HIGH: Today/tomorrow
- MEDIUM: 3-7 days
- LOW: No urgent deadline
- INFO: No action needed

Output as JSON.
```

---

**End of PRD**

*This document defines WHAT to build and WHY. Implementation details (HOW) are left open for technical innovation and problem-solving.*
